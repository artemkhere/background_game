{"ast":null,"code":"import _regeneratorRuntime from\"/Users/artemk/background_game/frontend/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/artemk/background_game/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import React,{useEffect}from'react';import{connect}from'react-redux';import axios from'axios';import\"./App.scss\";import{setUserData}from'./actions/userActions';import TopMenu from'./components/TopMenu';import ErrorModal from'./components/ErrorModal';import LoadingModal from'./components/LoadingModal';import LandingPage from'./components/LandingPage';import GameSession from'./components/GameSession/GameSession';import Login from'./components/Login';import Signup from'./components/Signup';import Logout from'./components/Logout';function App(props){var setUserData=props.setUserData,user=props.user,applicationState=props.applicationState;var authenticate=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(jwt){var authResponse,userData;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.post(\"http://127.0.0.1:6969/api/auth\",{token:jwt});case 3:authResponse=_context.sent;userData={id:authResponse.data.id,email:authResponse.data.email,loggedIn:true};setUserData(userData);_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);console.error('Error: failed to auth with jwt.');case 11:case\"end\":return _context.stop();}}},_callee,null,[[0,8]]);}));return function authenticate(_x){return _ref.apply(this,arguments);};}();useEffect(function(){var jwt=localStorage.getItem('jwt');if(jwt&&!user.loggedIn){authenticate(jwt);}});var renderMainSection=function renderMainSection(){var toRender;switch(applicationState.currentScreen){case'LandingPage':toRender=/*#__PURE__*/React.createElement(LandingPage,null);break;case'GameSession':toRender=/*#__PURE__*/React.createElement(GameSession,null);break;case'Login':toRender=/*#__PURE__*/React.createElement(Login,null);break;case'Signup':toRender=/*#__PURE__*/React.createElement(Signup,null);break;case'Logout':toRender=/*#__PURE__*/React.createElement(Logout,null);break;default:toRender=/*#__PURE__*/React.createElement(\"div\",null,\"Error\");}return toRender;};return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(TopMenu,null),applicationState.error&&/*#__PURE__*/React.createElement(ErrorModal,null),applicationState.loading&&/*#__PURE__*/React.createElement(LoadingModal,null),renderMainSection());}function mapStateToProps(state){return{applicationState:state.applicationState,user:state.user};}function mapDispatchToProps(dispatch){return{setUserData:setUserData(dispatch)};}export default connect(mapStateToProps,mapDispatchToProps)(App);","map":{"version":3,"sources":["/Users/artemk/background_game/frontend/src/App.js"],"names":["React","useEffect","connect","axios","setUserData","TopMenu","ErrorModal","LoadingModal","LandingPage","GameSession","Login","Signup","Logout","App","props","user","applicationState","authenticate","jwt","post","token","authResponse","userData","id","data","email","loggedIn","console","error","localStorage","getItem","renderMainSection","toRender","currentScreen","loading","mapStateToProps","state","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["import React, { useEffect } from 'react';\nimport { connect } from 'react-redux';\nimport axios from 'axios';\n\nimport \"./App.scss\";\n\nimport { setUserData } from './actions/userActions';\n\nimport TopMenu from './components/TopMenu';\nimport ErrorModal from './components/ErrorModal';\nimport LoadingModal from './components/LoadingModal';\nimport LandingPage from './components/LandingPage';\nimport GameSession from './components/GameSession/GameSession';\nimport Login from './components/Login';\nimport Signup from './components/Signup';\nimport Logout from './components/Logout';\n\nfunction App(props) {\n  const { setUserData, user, applicationState } = props;\n\n  const authenticate = async (jwt) => {\n    try {\n      const authResponse = await axios.post(\"http://127.0.0.1:6969/api/auth\", { token: jwt });\n      const userData = {\n        id: authResponse.data.id,\n        email: authResponse.data.email,\n        loggedIn: true\n      };\n      setUserData(userData);\n    } catch (error) {\n      console.error('Error: failed to auth with jwt.')\n    }\n  }\n\n  useEffect(() => {\n    const jwt = localStorage.getItem('jwt');\n    if (jwt && !user.loggedIn) { authenticate(jwt); }\n  });\n\n  const renderMainSection = () => {\n    let toRender;\n\n    switch(applicationState.currentScreen) {\n      case 'LandingPage':\n        toRender = <LandingPage />;\n        break;\n      case 'GameSession':\n        toRender = <GameSession />;\n        break;\n      case 'Login':\n        toRender = <Login />;\n        break;\n      case 'Signup':\n        toRender = <Signup />;\n        break;\n      case 'Logout':\n        toRender = <Logout />;\n        break;\n      default:\n        toRender = <div>Error</div>;\n    }\n\n    return toRender;\n  }\n\n  return (\n    <div>\n      <TopMenu />\n      {applicationState.error && <ErrorModal />}\n      {applicationState.loading && <LoadingModal />}\n      {renderMainSection()}\n    </div>\n  );\n}\n\nfunction mapStateToProps(state) {\n  return {\n    applicationState: state.applicationState,\n    user: state.user\n  };\n}\n\nfunction mapDispatchToProps(dispatch) {\n  return {\n    setUserData: setUserData(dispatch)\n  };\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(App);\n"]},"metadata":{},"sourceType":"module"}