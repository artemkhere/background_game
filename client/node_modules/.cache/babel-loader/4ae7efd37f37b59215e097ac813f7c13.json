{"ast":null,"code":"import socketIOClient from 'socket.io-client';\nimport { SOCKET_TRIGGER_CONNECT, SOCKET_CONNECT_ERROR, SOCKET_ERROR, SOCKET_TIMEOUT, SOCKET_CONNECT, SOCKET_DISCONNECT, SOCKET_TRIGGER_DISCONNECT } from '../actions/actionTypes';\nlet socket;\n\nconst createSocketMiddleware = url => {\n  // shouldn't have any idea of connect or disconnect\n  // abstract this from reconnect logic\n  return storeAPI => next => action => {\n    switch (action.type) {\n      case SOCKET_TRIGGER_CONNECT:\n        {\n          socket = socket || socketIOClient(url, {\n            forceNew: true\n          });\n          socket.on('connect', data => {\n            // handle hydration of game state from this data\n            console.log(SOCKET_CONNECT);\n            storeAPI.dispatch({\n              type: SOCKET_CONNECT,\n              payload: data\n            });\n          });\n          socket.emit('hello', 'world');\n          socket.on(\"FromAPI\", message => {\n            console.log(message);\n            console.log(\"FromAPI\"); // storeAPI.dispatch({\n            //   type: \"SOCKET_MESSAGE_RECEIVED\",\n            //   payload : message\n            // });\n          });\n          console.log(\"socket.connected\");\n          console.log(socket.connected);\n          socket.on('connect_error', error => {\n            console.log(SOCKET_CONNECT_ERROR);\n            storeAPI.dispatch({\n              type: SOCKET_CONNECT_ERROR,\n              payload: error\n            });\n          });\n          socket.on('error', error => {\n            console.log(SOCKET_ERROR);\n            storeAPI.dispatch({\n              type: SOCKET_ERROR,\n              payload: error\n            });\n          });\n          socket.on('connect_timeout', timeout => {\n            console.log(SOCKET_TIMEOUT);\n            storeAPI.dispatch({\n              type: SOCKET_TIMEOUT,\n              payload: timeout\n            });\n          });\n          socket.on('disconnect', timeout => {\n            console.log(SOCKET_DISCONNECT);\n            storeAPI.dispatch({\n              type: SOCKET_DISCONNECT,\n              payload: timeout\n            });\n          });\n        }\n\n      case SOCKET_TRIGGER_DISCONNECT:\n        {\n          if (socket) {\n            socket.disconnect();\n          }\n        }\n      // case \"SEND_WEBSOCKET_MESSAGE\": {\n      //     socket.send(action.payload);\n      //     return;\n      //     break;\n      // }\n    }\n\n    return next(action);\n  };\n};\n\nexport default createSocketMiddleware;","map":{"version":3,"sources":["/Users/artemk/background_game/frontend/src/store/socketMiddleware.js"],"names":["socketIOClient","SOCKET_TRIGGER_CONNECT","SOCKET_CONNECT_ERROR","SOCKET_ERROR","SOCKET_TIMEOUT","SOCKET_CONNECT","SOCKET_DISCONNECT","SOCKET_TRIGGER_DISCONNECT","socket","createSocketMiddleware","url","storeAPI","next","action","type","forceNew","on","data","console","log","dispatch","payload","emit","message","connected","error","timeout","disconnect"],"mappings":"AAAA,OAAOA,cAAP,MAA2B,kBAA3B;AACA,SACEC,sBADF,EAC0BC,oBAD1B,EACgDC,YADhD,EAEEC,cAFF,EAEkBC,cAFlB,EAEkCC,iBAFlC,EAGEC,yBAHF,QAIO,wBAJP;AAMA,IAAIC,MAAJ;;AAEA,MAAMC,sBAAsB,GAAIC,GAAD,IAAS;AACtC;AACA;AAEA,SAAOC,QAAQ,IAAIC,IAAI,IAAIC,MAAM,IAAI;AACnC,YAAOA,MAAM,CAACC,IAAd;AACE,WAAKb,sBAAL;AAA6B;AAC3BO,UAAAA,MAAM,GAAGA,MAAM,IAAIR,cAAc,CAACU,GAAD,EAAM;AAAEK,YAAAA,QAAQ,EAAE;AAAZ,WAAN,CAAjC;AAEAP,UAAAA,MAAM,CAACQ,EAAP,CAAU,SAAV,EAAsBC,IAAD,IAAU;AAC7B;AACAC,YAAAA,OAAO,CAACC,GAAR,CAAYd,cAAZ;AACAM,YAAAA,QAAQ,CAACS,QAAT,CAAkB;AAChBN,cAAAA,IAAI,EAAET,cADU;AAEhBgB,cAAAA,OAAO,EAAEJ;AAFO,aAAlB;AAID,WAPD;AASAT,UAAAA,MAAM,CAACc,IAAP,CAAY,OAAZ,EAAqB,OAArB;AAEAd,UAAAA,MAAM,CAACQ,EAAP,CAAU,SAAV,EAAsBO,OAAD,IAAa;AAChCL,YAAAA,OAAO,CAACC,GAAR,CAAYI,OAAZ;AACAL,YAAAA,OAAO,CAACC,GAAR,CAAY,SAAZ,EAFgC,CAGhC;AACA;AACA;AACA;AACD,WAPD;AASAD,UAAAA,OAAO,CAACC,GAAR,CAAY,kBAAZ;AACAD,UAAAA,OAAO,CAACC,GAAR,CAAYX,MAAM,CAACgB,SAAnB;AAEAhB,UAAAA,MAAM,CAACQ,EAAP,CAAU,eAAV,EAA4BS,KAAD,IAAW;AACpCP,YAAAA,OAAO,CAACC,GAAR,CAAYjB,oBAAZ;AACAS,YAAAA,QAAQ,CAACS,QAAT,CAAkB;AAChBN,cAAAA,IAAI,EAAEZ,oBADU;AAEhBmB,cAAAA,OAAO,EAAEI;AAFO,aAAlB;AAID,WAND;AAQAjB,UAAAA,MAAM,CAACQ,EAAP,CAAU,OAAV,EAAoBS,KAAD,IAAW;AAC5BP,YAAAA,OAAO,CAACC,GAAR,CAAYhB,YAAZ;AACAQ,YAAAA,QAAQ,CAACS,QAAT,CAAkB;AAChBN,cAAAA,IAAI,EAAEX,YADU;AAEhBkB,cAAAA,OAAO,EAAEI;AAFO,aAAlB;AAID,WAND;AAQAjB,UAAAA,MAAM,CAACQ,EAAP,CAAU,iBAAV,EAA8BU,OAAD,IAAa;AACxCR,YAAAA,OAAO,CAACC,GAAR,CAAYf,cAAZ;AACAO,YAAAA,QAAQ,CAACS,QAAT,CAAkB;AAChBN,cAAAA,IAAI,EAAEV,cADU;AAEhBiB,cAAAA,OAAO,EAAEK;AAFO,aAAlB;AAID,WAND;AAQAlB,UAAAA,MAAM,CAACQ,EAAP,CAAU,YAAV,EAAyBU,OAAD,IAAa;AACnCR,YAAAA,OAAO,CAACC,GAAR,CAAYb,iBAAZ;AACAK,YAAAA,QAAQ,CAACS,QAAT,CAAkB;AAChBN,cAAAA,IAAI,EAAER,iBADU;AAEhBe,cAAAA,OAAO,EAAEK;AAFO,aAAlB;AAID,WAND;AAOD;;AACD,WAAKnB,yBAAL;AAAgC;AAC9B,cAAIC,MAAJ,EAAY;AAAEA,YAAAA,MAAM,CAACmB,UAAP;AAAsB;AACrC;AACD;AACA;AACA;AACA;AACA;AAlEF;;AAqEA,WAAOf,IAAI,CAACC,MAAD,CAAX;AACD,GAvED;AAwED,CA5ED;;AA8EA,eAAeJ,sBAAf","sourcesContent":["import socketIOClient from 'socket.io-client';\nimport {\n  SOCKET_TRIGGER_CONNECT, SOCKET_CONNECT_ERROR, SOCKET_ERROR,\n  SOCKET_TIMEOUT, SOCKET_CONNECT, SOCKET_DISCONNECT,\n  SOCKET_TRIGGER_DISCONNECT\n} from '../actions/actionTypes';\n\nlet socket;\n\nconst createSocketMiddleware = (url) => {\n  // shouldn't have any idea of connect or disconnect\n  // abstract this from reconnect logic\n\n  return storeAPI => next => action => {\n    switch(action.type) {\n      case SOCKET_TRIGGER_CONNECT: {\n        socket = socket || socketIOClient(url, { forceNew: true });\n\n        socket.on('connect', (data) => {\n          // handle hydration of game state from this data\n          console.log(SOCKET_CONNECT);\n          storeAPI.dispatch({\n            type: SOCKET_CONNECT,\n            payload: data\n          });\n        });\n\n        socket.emit('hello', 'world');\n\n        socket.on(\"FromAPI\", (message) => {\n          console.log(message);\n          console.log(\"FromAPI\")\n          // storeAPI.dispatch({\n          //   type: \"SOCKET_MESSAGE_RECEIVED\",\n          //   payload : message\n          // });\n        });\n\n        console.log(\"socket.connected\")\n        console.log(socket.connected)\n\n        socket.on('connect_error', (error) => {\n          console.log(SOCKET_CONNECT_ERROR);\n          storeAPI.dispatch({\n            type: SOCKET_CONNECT_ERROR,\n            payload: error\n          });\n        });\n\n        socket.on('error', (error) => {\n          console.log(SOCKET_ERROR);\n          storeAPI.dispatch({\n            type: SOCKET_ERROR,\n            payload: error\n          });\n        });\n\n        socket.on('connect_timeout', (timeout) => {\n          console.log(SOCKET_TIMEOUT);\n          storeAPI.dispatch({\n            type: SOCKET_TIMEOUT,\n            payload: timeout\n          });\n        });\n\n        socket.on('disconnect', (timeout) => {\n          console.log(SOCKET_DISCONNECT);\n          storeAPI.dispatch({\n            type: SOCKET_DISCONNECT,\n            payload: timeout\n          });\n        });\n      }\n      case SOCKET_TRIGGER_DISCONNECT: {\n        if (socket) { socket.disconnect(); }\n      }\n      // case \"SEND_WEBSOCKET_MESSAGE\": {\n      //     socket.send(action.payload);\n      //     return;\n      //     break;\n      // }\n    }\n\n    return next(action);\n  }\n}\n\nexport default createSocketMiddleware;\n"]},"metadata":{},"sourceType":"module"}